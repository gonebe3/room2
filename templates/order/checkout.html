{% extends "layout.html" %}
{% block title %}Apmokėjimas{% endblock %}

{% block content %}
<div class="container checkout-container">
    <h2 class="checkout-title">Apmokėjimas</h2>

    <div class="checkout-main">
        <form method="POST" class="checkout-form">
            {{ form.hidden_tag() }}

            <div class="checkout-section-title">Pristatymo informacija</div>

            <div class="form-group">
                {{ form.recipient_name.label }}
                {{ form.recipient_name(class_="form-control") }}
                {% for error in form.recipient_name.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <div class="form-group">
                {{ form.recipient_phone.label }}
                {{ form.recipient_phone(class_="form-control") }}
                {% for error in form.recipient_phone.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <div class="form-group">
                {{ form.shipping_address.label }}
                {{ form.shipping_address(class_="form-control", rows="3") }}
                {% for error in form.shipping_address.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <!-- Nuolaidos kodo laukas su dviem mygtukais -->
            <div class="form-group">
                {{ form.discount_code.label }}
                <div class="input-group">
                    {{ form.discount_code(class_="form-control", placeholder="Įveskite nuolaidos kodą") }}
                    <button name="action" value="apply" class="btn btn-outline-secondary">Taikyti kodą</button>
                </div>
                {% for error in form.discount_code.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <div class="form-group">
                {{ form.total_price.label }}
                {{ form.total_price(class_="form-control", readonly=true) }}
            </div>

            <div class="checkout-submit">
                <a href="{{ url_for('cart.view_cart') }}" class="btn btn-secondary">Grįžti į krepšelį</a>
                <button name="action" value="confirm" class="btn btn-primary btn-block">Patvirtinti užsakymą</button>
            </div>
        </form>

        <div class="checkout-summary">
            <h3>Jūsų krepšelis</h3>
            <div class="checkout-summary-row">
                <span>Iš viso:</span>
                <span>{{ summary.total|round(2) }}€</span>
            </div>
            <div class="checkout-summary-row">
                <span>Prekių nuolaidos:</span>
                <span>-{{ summary.discount_items|round(2) }}€</span>
            </div>
            <div class="checkout-summary-row">
                <span>Kodo nuolaida:</span>
                <span>-{{ summary.code_discount|round(2) }}€</span>
            </div>
            <div class="checkout-summary-row">
                <span>Bendras sutaupymas:</span>
                <span>-{{ summary.total_discount|round(2) }}€</span>
            </div>
            <div class="checkout-summary-final">
                <span>Mokėti:</span>
                <span>{{ summary.total_final|round(2) }}€</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}
