{% extends "layout.html" %}
{% block title %}Papildyti balansą{% endblock %}

{% block content %}
<div class="container balance-container">
    <h2 class="balance-title">Papildyti balansą</h2>
    <div class="balance-card">
        <div class="balance-info">
            Turimas balansas:
            <span class="balance-amount">{{ user.balance|round(2) }} €</span>
        </div>

        <form id="stripe-balance-form" class="balance-form"
              autocomplete="off" name="stripe-balance" spellcheck="false" autocorrect="off" autocapitalize="off">
            <label for="balance-amount">Suma (€)</label>
            <input type="number" step="0.01" min="0.50" id="balance-amount" name="amount"
                placeholder="Pvz., 10.00" required autofocus autocomplete="off">

            <!-- Stripe kortelės laukas -->
            <label for="card-element" style="margin-top: 1.2rem;">Banko kortelė</label>
            <div id="card-element" class="stripe-card-element"
                 style="padding: 0.45rem 0.8rem; border-radius: 0.75rem; border: 1.1px solid #ccd2db; margin-bottom: 1.1rem; background: #fcfcff;"
                 autocomplete="off"></div>

            <!-- Stripe error/JS klaidų blokas -->
            <div id="stripe-error" class="form-error"
                 style="display:none; color:#c00; margin-bottom:0.7rem"></div>

            <button type="submit" class="btn btn-primary btn-block" style="margin-top:0.4rem;">Papildyti Stripe</button>
        </form>

        <div class="balance-pay-mock" style="margin-top: 1.3rem;">
            <img src="{{ url_for('static', filename='images/icons/stripe.svg') }}"
                 alt="Stripe" style="width:38px;height:38px;opacity:0.83;">
            <div class="balance-pay-mock-note">
                Mokėjimai vykdomi saugiu Stripe mokėjimo langeliu.<br>
                Testui galite naudoti kortelę <b>4242 4242 4242 4242</b>.
            </div>
        </div>
    </div>
</div>

<!-- Stripe publishable key į JS -->
<script>
    window.STRIPE_KEY = "{{ stripe_publishable_key }}";
</script>
<!-- Stripe.js -->
<script src="https://js.stripe.com/v3/"></script>
<!-- Pagrindinis tavo JS -->
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}