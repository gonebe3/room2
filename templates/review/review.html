{% extends "layout.html" %}
{% block title %}Atsiliepimai{% endblock %}

{% block content %}
<div class="container review-container">
    <h2 class="review-title">Atsiliepimai apie prekę: <span class="review-product-title">{{ product.title }}</span></h2>
    
    <!-- Atsiliepimo palikimo forma (jei vartotojas gali) -->
    {% if can_review %}
    <div class="review-add-form-wrap">
        <form method="POST" action="{{ url_for('add_review', product_id=product.id) }}" class="review-add-form">
            <label for="rating">Jūsų įvertinimas:</label>
            <div class="review-rating-stars">
                {% for i in range(1, 6) %}
                <input type="radio" name="rating" id="star{{ i }}" value="{{ i }}" {% if i == 5 %}checked{% endif %}>
                <label for="star{{ i }}">
                    <img src="{{ url_for('static', filename='images/icons/star.svg') }}" alt="{{ i }} žvaigždutės" class="icon-star">
                </label>
                {% endfor %}
            </div>
            <label for="comment">Komentaras:</label>
            <textarea name="comment" id="comment" rows="3" placeholder="Parašykite savo nuomonę..." required></textarea>
            <button type="submit" class="btn btn-primary btn-block">Pateikti atsiliepimą</button>
        </form>
    </div>
    {% endif %}

    <!-- Esami atsiliepimai -->
    <div class="review-list-wrap">
        <h3 class="review-list-title">Visi atsiliepimai</h3>
        {% if reviews %}
        <ul class="review-list">
            {% for review in reviews %}
            <li class="review-item">
                <div class="review-item-header">
                    <span class="review-user">{{ review.username }}</span>
                    <span class="review-date">{{ review.created_at.strftime('%Y-%m-%d') }}</span>
                </div>
                <div class="review-rating">
                    {% for i in range(1, 6) %}
                        {% if i <= review.rating %}
                            <img src="{{ url_for('static', filename='images/icons/star-filled.svg') }}" alt="*" class="icon-star">
                        {% else %}
                            <img src="{{ url_for('static', filename='images/icons/star.svg') }}" alt="-" class="icon-star">
                        {% endif %}
                    {% endfor %}
                </div>
                <div class="review-comment">{{ review.comment }}</div>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <div class="review-empty">Atsiliepimų dar nėra.</div>
        {% endif %}
    </div>
</div>
{% endblock %}