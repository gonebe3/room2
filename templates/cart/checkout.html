{% extends "layout.html" %}
{% block title %}Apmokėjimas{% endblock %}

{% block content %}
<div class="container checkout-container">
    <h2 class="checkout-title">Apmokėjimas</h2>

    <div class="checkout-main">
        <!-- Kairė pusė – forma -->
        <form method="POST" action="{{ url_for('checkout') }}" class="checkout-form">
            <h3 class="checkout-section-title">Pristatymo informacija</h3>
            <div class="form-group">
                <label for="name">Vardas, pavardė</label>
                <input type="text" id="name" name="name" required maxlength="60" placeholder="Pvz. Jonas Jonaitis">
            </div>
            <div class="form-group">
                <label for="address">Adresas</label>
                <input type="text" id="address" name="address" required maxlength="100" placeholder="Pvz. Gedimino pr. 1, Vilnius">
            </div>
            <div class="form-group">
                <label for="phone">Telefonas</label>
                <input type="tel" id="phone" name="phone" required maxlength="30" pattern="[\d+\-\s]+" placeholder="+370 600 00000">
            </div>
            <div class="form-group">
                <label for="email">El. paštas</label>
                <input type="email" id="email" name="email" required maxlength="80" placeholder="el.pastas@email.lt">
            </div>
            <!-- Ateityje: mokėjimo pasirinkimas -->
            <button type="submit" class="btn btn-primary btn-block checkout-submit">Apmokėti</button>
        </form>

        <!-- Dešinė pusė – užsakymo suvestinė -->
        <div class="checkout-summary">
            <h3 class="checkout-section-title">Užsakymo suvestinė</h3>
            <div class="checkout-summary-products">
                {% for item in cart.items %}
                    <div class="checkout-product">
                        <img src="{{ url_for('static', filename='images/products/' ~ item.product.image) }}"
                             class="checkout-product-img" alt="{{ item.product.title }}">
                        <div>
                            <div class="checkout-product-title">{{ item.product.title }}</div>
                            <div class="checkout-product-qty">x{{ item.qty }}</div>
                        </div>
                        <div class="checkout-product-price">
                            {% if item.product.discount_price %}
                                <span class="price-old">{{ item.product.price }}€</span>
                                <span class="price-new">{{ item.product.discount_price }}€</span>
                            {% else %}
                                <span class="price-new">{{ item.product.price }}€</span>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="checkout-summary-row">
                <span>Iš viso:</span>
                <span>{{ cart.total }}€</span>
            </div>
            <div class="checkout-summary-row">
                <span>Nuolaidos:</span>
                <span>-{{ cart.total_discount or 0 }}€</span>
            </div>
            <div class="checkout-summary-row checkout-summary-final">
                <span>Mokėti:</span>
                <span>{{ cart.total_final }}€</span>
            </div>
        </div>
    </div>

    {% if order_success %}
        <div class="checkout-success">
            <img src="{{ url_for('static', filename='images/icons/check-circle.svg') }}" alt="Sėkminga" class="checkout-success-icon">
            <div class="checkout-success-title">Ačiū, užsakymas priimtas!</div>
            <div class="checkout-success-text">Patvirtinimą gausite el. paštu. <br> Greitu metu susisieksime dėl pristatymo.</div>
            <a href="{{ url_for('product_list') }}" class="btn btn-primary">Grįžti į parduotuvę</a>
        </div>
    {% endif %}
</div>
{% endblock %}